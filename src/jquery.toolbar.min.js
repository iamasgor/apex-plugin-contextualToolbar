"function"!=typeof Object.create&&(Object.create=function(t){function o(){}return o.prototype=t,new o}),function(t,o,e){var i=function(t,e){var i="contextualToolbar";o.debug(i||" - "||t,e,this)},a={init:function(o,e){i.call(this,arguments.callee.name,arguments);var a=this;a.elem=e,a.$elem=t(e),a.options=t.extend({},t.fn.toolbar.options,o),a.metadata=a.$elem.data(),a.overrideOptions(),a.toolbar=t('<div class="tool-container" />').addClass("tool-"+a.options.position).addClass("toolbar-"+a.options.style).append('<div class="tool-items" />').append('<div class="arrow" />').appendTo("body").css("opacity",0).hide(),a.toolbar_arrow=a.toolbar.find(".arrow"),a.initializeToolbar()},overrideOptions:function(){i.call(this,arguments.callee.name,arguments);var o=this;t.each(o.options,function(t){"undefined"!=typeof o.$elem.data("toolbar-"+t)&&(o.options[t]=o.$elem.data("toolbar-"+t))})},initializeToolbar:function(){i.call(this,arguments.callee.name,arguments);var t=this;t.populateContent(),t.setTrigger(),t.toolbarWidth=t.toolbar.width()},setTrigger:function(){function o(){a.$elem.hasClass("pressed")?n=setTimeout(function(){a.hide()},150):clearTimeout(n)}function o(){a.$elem.hasClass("pressed")?n=setTimeout(function(){a.hide()},150):clearTimeout(n)}i.call(this,arguments.callee.name,arguments);var a=this;if("click"!=a.options.event){var n;a.$elem.on({mouseenter:function(){a.$elem.hasClass("pressed")?clearTimeout(n):a.show()}}),a.$elem.parent().on({mouseleave:function(){o()}}),t(".tool-container").on({mouseenter:function(){clearTimeout(n)},mouseleave:function(){o()}})}if("click"==a.options.event&&(a.$elem.on("click",function(t){t.preventDefault(),a.$elem.hasClass("pressed")?a.hide():a.show()}),a.options.hideOnClick&&t("html").on("click.toolbar",function(t){t.target!=a.elem&&0===a.$elem.has(t.target).length&&0===a.toolbar.has(t.target).length&&a.toolbar.is(":visible")&&a.hide()})),a.options.hover){var n;a.$elem.on({mouseenter:function(){a.$elem.hasClass("pressed")?clearTimeout(n):a.show()}}),a.$elem.parent().on({mouseleave:function(){o()}}),t(".tool-container").on({mouseenter:function(){clearTimeout(n)},mouseleave:function(){o()}})}t(e).resize(function(t){t.stopPropagation(),a.toolbar.is(":visible")&&(a.toolbarCss=a.getCoordinates(a.options.position,20),a.collisionDetection(),a.toolbar.css(a.toolbarCss),a.toolbar_arrow.css(a.arrowCss))})},populateContent:function(){i.call(this,arguments.callee.name,arguments);var o=this,a=o.toolbar.find(".tool-items"),n=t(o.options.content).clone(!0).find("a").addClass("tool-item");a.html(n),a.find(".tool-item").on("click",function(t){t.preventDefault()}),a.find(".tool-item").on(o.options.itemEvent,function(i){i.preventDefault(),e.location.href=t(this).attr("href"),o.$elem.trigger("toolbarItemClick")})},calculatePosition:function(){i.call(this,arguments.callee.name,arguments);var t=this;t.arrowCss={},t.toolbarCss=t.getCoordinates(t.options.position,t.options.adjustment),t.toolbarCss.position="absolute",t.toolbarCss.zIndex=t.options.zIndex,t.collisionDetection(),t.toolbar.css(t.toolbarCss),t.toolbar_arrow.css(t.arrowCss)},getCoordinates:function(t,o){i.call(this,arguments.callee.name,arguments);var e=this;switch(e.coordinates=e.$elem.offset(),o=parseInt(e.options.adjustment),e.options.position){case"top":return{left:e.coordinates.left-e.toolbar.width()/2+e.$elem.outerWidth()/2,top:e.coordinates.top-e.$elem.outerHeight()-o,right:"auto"};case"left":return{left:e.coordinates.left-e.toolbar.width()/2-e.$elem.outerWidth()/2-o,top:e.coordinates.top-e.toolbar.height()/2+e.$elem.outerHeight()/2,right:"auto"};case"right":return{left:e.coordinates.left-e.toolbar.width()/2+e.$elem.outerWidth()/2+o,top:e.coordinates.top-e.toolbar.height()/2+e.$elem.outerHeight()/2,right:"auto"};case"bottom":return{left:e.coordinates.left-e.toolbar.width()/2+e.$elem.outerWidth()/2,top:e.coordinates.top+e.$elem.outerHeight()+o,right:"auto"}}},collisionDetection:function(){i.call(this,arguments.callee.name,arguments);var o=this,a=20;"top"!=o.options.position&&"bottom"!=o.options.position||(o.arrowCss={left:"50%",right:"50%"},o.toolbarCss.left<a?(o.toolbarCss.left=a,o.arrowCss.left=o.$elem.offset().left+o.$elem.width()/2-a):t(e).width()-(o.toolbarCss.left+o.toolbarWidth)<a&&(o.toolbarCss.right=a,o.toolbarCss.left="auto",o.arrowCss.left="auto",o.arrowCss.right=t(e).width()-o.$elem.offset().left-o.$elem.width()/2-a-5))},show:function(){i.call(this,arguments.callee.name,arguments);var t=this;t.$elem.addClass("pressed"),t.calculatePosition(),t.toolbar.show().css({opacity:1}).addClass("animate-"+t.options.animation),t.$elem.trigger("toolbarShown")},hide:function(){i.call(this,arguments.callee.name,arguments);var t=this,o={opacity:0};switch(t.$elem.removeClass("pressed"),t.options.position){case"top":o.top="+=20";break;case"left":o.left="+=20";break;case"right":o.left="-=20";break;case"bottom":o.top="-=20"}t.toolbar.animate(o,200,function(){t.toolbar.hide()}),t.$elem.trigger("toolbarHidden")},getToolbarElement:function(){return i.call(this,arguments.callee.name,arguments),this.toolbar.find(".tool-items")}};t.fn.toolbar=function(o){if(t.isPlainObject(o))return this.each(function(){var e=Object.create(a);e.init(o,this),t(this).data("toolbarObj",e)});if("string"==typeof o&&0!==o.indexOf("_")){var e=t(this).data("toolbarObj"),i=e[o];return i.apply(e,t.makeArray(arguments).slice(1))}},t.fn.toolbar.options={content:"#myContent",position:"top",hideOnClick:!1,zIndex:1e7,hover:!1,style:"default",animation:"standard",adjustment:10,itemEvent:"click"}}(apex.jQuery,apex,window,document);